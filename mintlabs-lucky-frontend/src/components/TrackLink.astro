---
const {
  href = "#",
  class: klass = "",
  rel = "nofollow sponsored noopener",
  event = "link_click",
  props = {},
} = Astro.props as {
  href?: string;
  class?: string;
  rel?: string;
  event?: string;
  props?: Record<string, unknown>;
};

const id = `tl-${Math.random().toString(36).slice(2, 9)}`;
const payload = JSON.stringify(props ?? {});
---
<a
  id={id}
  href={href}
  rel={rel}
  class={klass}
  data-track-event={event}
  data-track-props={payload}
>
  <slot />
</a>

<!-- TrackLink intentionally has no per-link inline import handlers.
     We use a single global delegation hook for data-track-event attributes
     (registered at app boot) so instrumentation is resilient and bundled
     correctly for all pages. -->
