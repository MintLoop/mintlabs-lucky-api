<div class="flex flex-col sm:flex-row sm:items-center sm:justify-end gap-2 mt-2 mb-2">
  <label for="themeSelect" class="sr-only">Theme</label>
  <select id="themeSelect"
    class="w-full sm:w-auto shrink-0 theme-bg-card theme-text-primary theme-border-primary border
           rounded-lg h-9 px-3 pr-8 bg-clip-padding backdrop-blur-sm text-sm focus:outline-none
           focus:ring-2 focus:ring-[var(--accent-primary)]">
    <!-- Dark -->
    <option value="green-dark">Classic</option>
    <option value="blue-dark">Alpine</option>
    <option value="purple-dark">Perilla</option>
    <option value="amber-dark">Eau de Cologne</option>
    <option value="red-dark">Red</option>
    <option value="teal-dark">Teal</option>
    <option value="bw-dark">Monochrome</option>
    <!-- Light -->
    <option value="green-light">Classic Light</option>
    <option value="blue-light">Alpine Light</option>
    <option value="purple-light">Perilla Light</option>
    <option value="amber-light">Eau de Cologne Light</option>
    <option value="red-light">Red Light</option>
    <option value="teal-light">Teal Light</option>
    <option value="bw-light">Monochrome Light</option>
  </select>
</div>

<script is:inline>
  const sel = document.getElementById('themeSelect');
  const apply = t => { document.documentElement.setAttribute('data-theme', t); localStorage.setItem('selectedTheme', t); };
  sel.value = document.documentElement.getAttribute('data-theme') || 'green-dark';
  apply(sel.value);
  sel.addEventListener('change', e => apply(e.target.value));

  // lock width to longest option on â‰¥sm; full-width on mobile
  const mq = matchMedia('(min-width: 640px)');
  const fit = () => {
    if (!mq.matches) { sel.style.width = '100%'; return; }
    const p = sel.cloneNode(true);
    Object.assign(p.style,{position:'absolute',visibility:'hidden',height:'auto',width:'auto',whiteSpace:'nowrap'});
    document.body.appendChild(p);
    let max=0; for (let i=0;i<p.options.length;i++){ p.selectedIndex=i; max=Math.max(max,p.scrollWidth); }
    p.remove(); sel.style.width = Math.ceil(max+32)+'px';
  };
  addEventListener('load',fit); addEventListener('resize',fit); sel.addEventListener('change',fit);
</script>
